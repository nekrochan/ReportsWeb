version: "3.7"

services:
  elasticsearch:
  image: elasticsearch:8.4.3
  container_name: elasticsearch
  environment:
    - node.name=elasticsearch
    - xpack.security.enabled=false
    - xpack.security.authc.api_key.enabled=false
    - discovery.type=single-node
    - bootstrap.memory_lock=true
    - "ES_JAVA_OPTS=-Xms512m -Xmx512m"
  ports:
    - "9200:9200"
    - "9300:9300"
  healthcheck:
  test: ["CMD-SHELL", "curl --silent --fail localhost:9200/_cluster/health || exit 1"]
  interval: 10s
  timeout: 10s
  retries: 3
  networks:
    - elastic

  kibana:
  image: kibana:8.4.3
  container_name: kibana
  environment:
    - ELASTICSEARCH_HOSTS=http://elasticsearch:9200
  ports:
    - "5601:5601"
  depends_on:
    - elasticsearch
  networks:
    - elastic

networks:
  elastic:
  driver: bridge